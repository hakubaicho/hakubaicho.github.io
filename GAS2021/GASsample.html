<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width-device-width, initial-scale=1.0">
    <title>A社の無事故日数</title>
    <style>
        table {
            font-size: 2vw;
        }

        .font-large {
            font-size: 3vw;
        }
    </style>
</head>

<body>

    <div class="font-large">
        <p id="status-of-api">未取得</p>
        <button class="font-large" type="button" onclick="inputToGoogleAPI()">データの取得</button>
    </div>
    <div>
        <table border="1" style="width:100%">
            <tr>
                <th>工場名</th>
                <th>開始日付</th>
                <th>経過日数</th>
                <th>日付設定</th>
                <th>サインURL</th>
            </tr>
            <tr>
                <td>第1工場</td>
                <td><label id="api-result-startday_1"></label></td>
                <td><label id="api-result-pastday_1"></label></td>
                <td><a href="https://forms.gle/QenBP4LpJimToSoq9" target="blank">設定</a></td>
                <td><a href="factory-01.html" target="blank">URL</a></td>
            </tr>
            <tr>
                <td>第2工場</td>
                <td><label id="api-result-startday_2"></label></td>
                <td><label id="api-result-pastday_2"></label></td>
                <td><a href="https://forms.gle/SNdw6mf9UP6Ert9PA" target="blank">設定</a></td>
                <td><a href="factory-02.html" target="blank">URL</a></td>
            </tr>
            <tr>
                <td>第3工場</td>
                <td><label id="api-result-startday_3"></label></td>
                <td><label id="api-result-pastday_3"></label></td>
                <td><a href="https://forms.gle/5f5hvWBVXQ9LkpvY8" target="blank">設定</a></td>
                <td><a href="factory-03.html" target="blank">URL</a></td>
            </tr>
            <tr>
                <td>第4工場</td>
                <td><label id="api-result-startday_4"></label></td>
                <td><label id="api-result-pastday_4"></label></td>
                <td><a href="https://forms.gle/va6rXmYcHbcN6DcT6" target="blank">設定</a></td>
                <td><a href="factory-04.html" target="blank">URL</a></td>
            </tr>
            <tr>
                <td>第5工場</td>
                <td><label id="api-result-startday_5"></label></td>
                <td><label id="api-result-pastday_5"></label></td>
                <td><a href="https://forms.gle/tQ2pRSt1ZKYdWeTY6" target="blank">設定</a></td>
                <td><a href="factory-05.html" target="blank">URL</a></td>
            </tr>
            <tr>
                <td>第6工場</td>
                <td><label id="api-result-startday_6"></label></td>
                <td><label id="api-result-pastday_6"></label></td>
                <td><a href="https://forms.gle/NnejkzPYGGmWCsgJ9" target="blank">設定</a></td>
                <td><a href="factory-06.html" target="blank">URL</a></td>
            </tr>
            <tr>
                <td>第7工場</td>
                <td><label id="api-result-startday_7"></label></td>
                <td><label id="api-result-pastday_7"></label></td>
                <td><a href="https://forms.gle/6NXT4R2QXwNuGDYT9" target="blank">設定</a></td>
                <td><a href="factory-07.html" target="blank">URL</a></td>
            </tr>
            <tr>
                <td>第8工場</td>
                <td><label id="api-result-startday_8"></label></td>
                <td><label id="api-result-pastday_8"></label></td>
                <td><a href="https://forms.gle/BEPi531dMaNFCmzn6" target="blank">設定</a></td>
                <td><a href="factory-08.html" target="blank">URL</a></td>
            </tr>
            <tr>
                <td>第9工場</td>
                <td><label id="api-result-startday_9"></label></td>
                <td><label id="api-result-pastday_9"></label></td>
                <td><a href="https://forms.gle/nrdApSCkbRfffT74A" target="blank">設定</a></td>
                <td><a href="factory-09.html" target="blank">URL</a></td>
            </tr>
            <tr>
                <td>第10工場</td>
                <td><label id="api-result-startday_10"></label></td>
                <td><label id="api-result-pastday_10"></label></td>
                <td><a href="https://forms.gle/Kh2nrya81L7TQPvj6" target="blank">設定</a></td>
                <td><a href="factory-10.html" target="blank">URL</a></td>
            </tr>
        </table>
    </div>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script>
        const endpoint = "https://script.google.com/macros/s/AKfycbzdq61ve4lpZy7cvJd0XZ-JfuRVJuLm0U8PDU8ivX38UQgNamfxwmyCgtxz_Bl9avVN/exec"
        // const endpoint = "https://script.google.com/macros/s/AKfycbyqTt4bRNmiNNJEo1RzJdVVrx5OoRqXS1xB0F3dMn9D3BOWFRbAje48KwZswi3rG6_7jA/exec";
        function inputToGoogleAPI() {
            // const inputvalue = document.getElementById('inputText').value;
            // alert(inputvalue);
            // return;
            document.getElementById('status-of-api').textContent = "データ取得中";
            $.ajax({
                type: 'GET',
                url: endpoint,
                dataType: 'jsonp',
                data: {
                    text: 'Hi,There!'
                    // text: inputvalue
                },
                success: out => {
                    // alert(out.message);
                    // document.getElementById('api-result').textContent = out.message;
                    document.getElementById('api-result-startday_1').textContent = out.startDate_1;
                    document.getElementById('api-result-pastday_1').textContent = out.pastDay_1;
                    document.getElementById('api-result-startday_2').textContent = out.startDate_2;
                    document.getElementById('api-result-pastday_2').textContent = out.pastDay_2;
                    document.getElementById('api-result-startday_3').textContent = out.startDate_3;
                    document.getElementById('api-result-pastday_3').textContent = out.pastDay_3;
                    document.getElementById('api-result-startday_4').textContent = out.startDate_4;
                    document.getElementById('api-result-pastday_4').textContent = out.pastDay_4;
                    document.getElementById('api-result-startday_5').textContent = out.startDate_5;
                    document.getElementById('api-result-pastday_5').textContent = out.pastDay_5;

                    document.getElementById('api-result-startday_6').textContent = out.startDate_6;
                    document.getElementById('api-result-pastday_6').textContent = out.pastDay_6;
                    document.getElementById('api-result-startday_7').textContent = out.startDate_7;
                    document.getElementById('api-result-pastday_7').textContent = out.pastDay_7;
                    document.getElementById('api-result-startday_8').textContent = out.startDate_8;
                    document.getElementById('api-result-pastday_8').textContent = out.pastDay_8;
                    document.getElementById('api-result-startday_9').textContent = out.startDate_9;
                    document.getElementById('api-result-pastday_9').textContent = out.pastDay_9;
                    document.getElementById('api-result-startday_10').textContent = out.startDate_10;
                    document.getElementById('api-result-pastday_10').textContent = out.pastDay_10;

                    // データ取得の結果
                    let todayDate = new Date();
                    let strDate = "";
                    strDate += `${todayDate.getFullYear()}/${todayDate.getMonth() + 1}/${todayDate.getDay()}`;
                    strDate += " ";
                    strDate += `${todayDate.getHours()}:${todayDate.getMinutes()}/${todayDate.getMinutes()}`;
                    document.getElementById('status-of-api').textContent = `データ取得完了:${strDate}`;
                }
            });
        }
    </script>
</body>

</html>