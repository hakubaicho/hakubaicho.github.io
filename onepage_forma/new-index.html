<!DOCTYPE html>
<html lang="ja">
	<head>
		<meta charset="utf-8">
		<!-- 
			幅:1080に固定する
			ほかにいいアイデアったらお願いします。
		-->
		<meta name="viewport" content="width=1080,initial-scale=1">
		<title>アイテム選択画面</title>
		
		<!-- Index.html -->
		<link rel="stylesheet" href="css/styles.css">
		<link rel="stylesheet" href="css/select_item.css">
		<link rel="stylesheet" href="css/accordion_check.css">
		<link rel="stylesheet" href="css/accordion_radio.css">
		<!-- Camera.html -->
		<link rel="stylesheet" href="css/camara.css">
		<link rel="stylesheet" href="css/talkstyle.css">
		<!-- Order.html -->
		<link rel="stylesheet" href="css/order.css">
		
  </head>
  <body>

		<!-- ******************************************************************************* -->
		<!-- index.html -->
		<!-- ******************************************************************************* -->
		<!-- index-loading画面 -->
    <div id="index-loading">
			<div class="spinner"></div>
      <p class="title_logo">Tシャツを作ってみる！</p>
    </div>
		
    <!-- indexのメイン部分 -->
    <div id="index-page">
			<!-- HEADER -->
			<header>
				<div class="header-container">
					<!-- <p>header</p> -->
					<!-- 画像の表示　選択されたデザイン -->
					<div class="header_box">
						<img id="thumbnail_selected">
					</div>
					<div class="header_box">
						<img id="thumbnail_selected_tryon">
					</div>
					<div class="header_box header_box_last item-hide" id="detail-box">
						<div class="detail-box">
							<table class="detailtable">
								<tr>
									<td class="detail_column_title"><span class="cell_title">大分類:</span></td>
									<td class="detail_column_data"><span class="cell_data" id="item_detail_tag1"></span></td>
								</tr>
								<tr>
									<td class="detail_column_title"><span class="cell_title">中分類:</span></td>
									<td class="detail_column_data"><span class="cell_data" id="item_detail_tag2"></span></td>
								</tr>
								<tr>
									<td class="detail_column_title"><span class="cell_title">小分類:</span></td>
									<td class="detail_column_data"><span class="cell_data" id="item_detail_tag3"></span></td>
								</tr>
								<tr>
									<td class="detail_column_title"><span class="cell_title">名称:</span></td>
									<td class="detail_column_data"><span class="cell_data" id="item_detail_name"></span></td>
								</tr>
								<tr>
									<td class="detail_column_title"><span class="cell_title">No:</span></td>
									<td class="detail_column_data"><span class="cell_data" id="item_detail_designID"></span></td>
								</tr>
							</table>
						</div>
					</div>
					<!-- 画像の表示　選択されたデザインの人が試着しているもの -->
				</div>
			</header>
			
			<!-- NAV -->
			<nav>
				<div class="nav-container">
					<div class="button_category button_tag1" id="button_category_tag1"><span id="category_tag1">大分類</span></div>
					<div class="button_category button_tag2" id="button_category_tag2"><span id="category_tag2">中分類</span></div>
					<div class="button_category button_tag3" id="button_category_tag3"><span id="category_tag3">小分類</span></div>
				</div>
			</nav>
			
			<!-- MAIN-AREA -->
			<div class="main-area-container">
				<!-- MAIN -->
				<main>
					<!-- Itemの詳細を表示する -->
					<div class="main-container">
						<div class="item_list_container">
							<!-- スクロールリセット要素 -->
							<div id="topPos"></div>
							<!-- 画像のリスト -->
							<ul class="thumbnails">
							</ul>
						</div>
					</div>
				</main>
				<!-- ASEIDE -->
				<aside>
					<!-- カテゴリーを表示する -->
					<div class="aside-container">
						<div id="accordionbox" class="category_list_container"></div>
					</div>
				</aside>
			</div>
				
			<!-- FOOTER -->
			<footer>
				<!-- <p>footer</p> -->
				<div class="footer-container">
					<!-- <button class="button_command" onclick="gotoCamera()">撮影して試着</button> -->
					<button class="button_command" onclick="jumpto_Camera()">撮影して試着</button>
					<button class="button_command" onclick="jumpto_Order()">撮影せずに購入</button>
				</div>
				<div class="footer-command-area">
					<button class="button_warning" onclick="setCategoryListTree_checkbox()">チェックボックス</button>
					<button class="button_warning" onclick="setCategoryListTree_radiobutton()">ラジオ</button>
					
					<button class="button_caution" onclick="location.href='test_fade.html'">試着中デモ</button>
					<button class="button_caution" onclick="endproc()">終 了</button>
				</div>
			</footer>
		</div>
		
		<!-- ******************************************************************************* -->
		<!-- camera.html -->
		<!-- ******************************************************************************* -->
		<!-- 写真の登録・トライオン中のローディング画面 -->
		<div id="camera-tryon" class="loaded">
			<!-- タイトル -->
			<p>Status : <span id="title_logo">Tシャツを作ってみる！</span></p>
			<!-- くるくる -->
			<div class="spinner"></div>
			<!-- 吹き出しでフェーズ -->
			<div class="area_talk">
				<ul class="messages">
					<!-- 1番目 -->
					<li class="left_side">
						<div class="pic">
							<!-- <img id="logo_moving_1" src="img/c1_character_pc.gif"> -->
							<img id="logo_1" src="img/c1_character_sp.gif">
							<img id="logo_moving_1" class="hidden_image" src="img/c1_character_pc.gif">
							<img id="logo_stop_1" class="hidden_image" src="img/c1_character_greet.png">
						</div>
						<div id="phase_1" class="text_conatainer">
							<div class="text_header">
								写真をとうろく
							</div>
							<div class="text" id="phase_1_text">
								<!-- あなたの写真をとうろくちゅうです -->
							</div>
						</div>
					</li>
					<!-- 2番目 -->
					<li class="right_side">
						<div class="pic">
							<!-- <img class="loading_icon_gif loading_icon_left" src="img/c2_character_pc.gif"> -->
							<img id="logo_2" src="img/c2_character_sp.gif">
							<img id="logo_moving_2" class="hidden_image" src="img/c2_character_pc.gif">
							<img id="logo_stop_2" class="hidden_image" src="img/c2_character_greet.png">
						</div>
						<div id="phase_2" class="text_conatainer">
							<div class="text_header">
								Tシャツをとうろく
							</div>
							<div class="text" id="phase_2_text">
								<!-- 着てみるTしゃつをとうろくちゅうです -->
							</div>
						</div>
					</li>
					<!-- 3番目 -->
					<li class="left_side">
						<div class="pic">
							<!-- <img id="logo_moving_3" src="img/c3_character_pc.gif"> -->
							<img id="logo_3" src="img/c3_character_sp.gif">
							<img id="logo_moving_3" class="hidden_image" src="img/c3_character_pc.gif">
							<img id="logo_stop_3" class="hidden_image" src="img/c3_character_greet.png">
						</div>
						<div id="phase_3" class="text_conatainer">
							<div class="text_header">
								きせかえ
							</div>
							<div class="text" id="phase_3_text">
								<!-- あなたにTシャツをきせています -->
							</div>
						</div>
					</li>
					<!-- 4番目 -->
					<li class="right_side">
						<div class="pic">
							<!-- <img id="logo_moving_4" src="img/c4_character_pc.gif"> -->
							<img id="logo_4" src="img/c4_character_sp.gif">
							<img id="logo_moving_4" class="hidden_image" src="img/c4_character_pc.gif">
							<img id="logo_stop_4" class="hidden_image" src="img/c4_character_greet.png">
						</div>
						<div id="phase_4" class="text_conatainer">
							<div class="text_header">
								みてみて
							</div>
							<div class="text" id="phase_4_text">
								<!-- さあ　にあっているかな？ -->
							</div>
						</div>
					</li>
					<!-- おわり -->
				</ul>
			</div>
		</div>
    <!-- モーダルウィンドウ プライバシーポリシーの表示 -->
    <section id="modal" class="hidden">
      <div>
        <!-- プライバシーポリシー文章 -->
        <div id="modal_text_container">
          <p class="permission_camera">
            プライバシーポリシー
            <br>
            下記を確認して下さい。
          </p>
          <p class="permission_message">
            ◆はじめに<br>
            株式会社テンプレートグループ（以下、当グループ）は、個人情報の取り扱いにおいて、下記のように定めます。<br>
            
            以下のプライバシーポリシーでは、個人情報の取得・利用・管理について記載しております。サービス利用にあたり、個人情報保護方針をお読みになり、ご理解いただけますと幸いです。<br>
            
            ◆個人情報の取得<br>
            当サービスでは、ユーザーの皆様の個人情報（氏名、住所、メールアドレス、電話番号など個人を特定できる情報）を取得させて頂くことがあります。<br>
            
            ◆個人情報の利用<br>
            取得した個人情報は、下記の目的で利用いたします。<br>
            (1)ユーザーニーズに合わせたサービス提供<br>
            (2)サービス改善に関するマーケティング<br>
            (3)資料送付などの際の本人確認<br>
            
            ◆個人情報の安全管理<br>
            当グループでは個人情報の管理について、全従業員・役員に対して第三者機関による教育研修を四半期に1度のペースで実施しています。<br>
            また社則に個人情報保護規定を設け、現場での管理について厳格にチェックを行っています。<br>
            
            ◆第三者への開示・提供の禁止<br>
            基本的に個人情報は第三者には提供しませんが、個人情報の保護に関する法律第23条第1項各号により、法令に基づいて提供する場合があります。<br>
            
            ◆個人情報に関する問い合わせ<br>
            個人情報に関するお問い合わせは、下記までお願い致します。<br>
            情報管理部 担当:山下<br>
            電話番号:0120-000-000<br>
            メールアドレス:jouhoukanri@xxxxxxx<br>
            
            ◆改変と見直しについて<br>
            個人情報については、法令変更などを受けて随時見直しを行います。<br>
          </p>
        </div>
      </div>
      <!-- 今回の写真撮影 -->
      <div class="footer-container">
        <button id="cancel" onclick="jumpto_index()" class="button_command">やめる</button>
        <button id="accept" onclick="camera_accept_click()" class="button_command hidden">撮影する</button>
      </div>
      <!-- 前回の写真の再利用 -->
      <div id="after_login" class="item-hide">
        <div class="footer-container">
          <button id="reuseAvatar" class="button_command item-hide">前回の写真から</button>
        </div>
      </div>
    </section>
    <!-- モーダルウィンドウの時のマスク -->
    <div id="mask" class="hidden"></div>
		<!-- カメラ撮影結果表示 -->
		<div id="camera_result" class="loaded">
			<!-- 画像の表示エリア -->
			<div id="camera_result_header">
				<!-- TryOnの結果画像 -->
				<img id="tryon_result_picture">
			</div>
			<!-- ボタンエリア -->
			<div  id="camera_result_footer">
				<div class="footer-container">
					<button class="button_command" onclick="jumpto_index()">選びなおす</button>
					<button class="button_command" onclick="jumpto_Order()">購入</button>
				</div>
			</div>
		</div>
		<!-- cameraのメイン部分 -->
		<div id="camera-page" class="loaded">
			<!-- HEADER -->
			<!-- NAV -->
			<!-- MAIN -->
			<main>
				<!-- カメラ -->
				<div id="area-capture" class="area-container">
					<div id="video_container">
						<!-- VIDEOの映像 -->
						<video id="camera" autoplay="1">
							<p>動画の再生に対応していません</p>
						</video>
						<!-- チャプチャーした画像 -->
						<canvas id="canvas-photo"></canvas>
					</div>
				</div>
			</main>
			
			
			<!-- FOOTER -->
			<footer>
				<!-- コントロールボタン -->
				<div id="area-button" class="area-container">
					<div class="box_command">
						<!-- <img src="img/arrow_left.png" id="btn_image_back" onclick="btnimg_click_back()"> -->
						<img src="img/arrow_left.png" id="btn_image_back" onclick="jumpto_index()">
						<p>選びなおす</p>
					</div>
					<div class="box_command">
						<img src="img/shutter.png" id="btn_image_shutter" onclick="btnimg_click_shutter()">
						<p>撮影</p>
						<p>(撮り直し)</p>
					</div>
					<div class="box_command">
						<img src="img/arrow_right.png" id="btn_image_save" onclick="btnimg_click_save()">
						<p>試着</p>
					</div>
				</div>
				<div>
					<p>
						<span id="camera-status"></span>
					</p>
					<p>
						<span id="Forma_status"></span>
					</p>
					<p>
						<span id="forma_login"></span>
					</p>
					<p>itemUUID: 
						<span id="itemuuid"></span>
					</p>
					<p>avatarUUID: 
						<span id="avataruuid"></span>
					</p>
				</div>
				<!-- 音声 -->
				<div id="area-sound" class="area-container" hidden>
					<p>
						<button type=button onclick="play_countdown()">テスト再生</button>
						<span>再生状態:<span id="soundStatus"></span></span>
					</p>
					<!-- 
						audioタグで先読みしておいたほうがいいです。
						じゃないとエラーが出ました。
						controlsでコントロールGUIの表示をします。
					-->
					<audio id="sound-countdown" controls src="sound/countdown3to1.mp3"></audio>
					<audio id="sound-shutter" controls src="sound/shutter.mp3"></audio>
				</div>
				<!-- カメラコントロール -->
				<div id="area-camera-ctrl" class="area-container">
					<!-- 解像度の設定ボタン -->
					<div>
						<button type="button" class="button_command" onclick="videoSize(1024, 576)">H:1024 * W:576</button>
						<button type="button" class="button_command" onclick="videoSize(576, 1024)">H:576 * W:1024</button>
					</div>
					<!-- VIDEO選択画面 -->
					<div>
						<select id="camera_list" size="1" style="width:160pt;">
							<option>(video)</option>
						</select>
						<button id="start_video_button" class="button_command" onclick="startSelectedVideo()">Start Video</button>
					</div>
					<p>H:<span id="resolution-height"></span></p>
					<p>W:<span id="resolution-width"></span></p>
					<div id="camera-devices">
						<p>mediaDevicesを列挙します。</p>
						<button type="button" onclick="getCameraDevices()">取得</button>
						<div id="list-camera-devices">
						</div>
					</div>
				</div>
			</footer>
		</div>

		<!-- ******************************************************************************* -->
		<!-- order.html -->
		<!-- ******************************************************************************* -->
		<div id="order-page" class="loaded">
			<!-- HEADER -->
			<header>
				<div class="header-container">
	
				</div>
			</header>
			
			<!-- NAV -->
			<nav>
				<div class="nav-container">
					<div class="order_title">
						<span>購入画面</span>
					</div>
				</div>
			</nav>
			<!-- MAIN-AREA -->
			<div class="main-area-container">
				<!-- MAIN -->
				<main>
					<div class="main-container">
						
						<!-- 注文確認エリア -->
						<div class="order_container">
							<!-- デザイン -->
							<div class="order_design_container">
								<img id="order_design_image">
							</div>
							<!-- 注文詳細 -->
							<div class="order_detail_container">
								<!-- デザイン番号 -->
								<p class="design_id" id="designID"></p>
								<!-- 価格 -->
								<p><span class="yen_mark">￥ </span><span class="price" id="ItemPrice">2,189</span></p>
								<!-- サイズ選択 -->
								<table>
									<tr>
										<td>
											<span class="size-category">Ledies</span>
										</td>
										<td>
											<label><input type="radio" name="size" value="Ladies) M"><span class="size-caption">M</span></label>
										</td>
										<td>
											<label><input type="radio" name="size" value="Ladies) L"><span class="size-caption">L</span></label>
										</td>
									</tr>
									<tr>
										<td>
											<span class="size-category">Mens</span>
										</td>
										<td>
											<label><input type="radio" name="size" value="Mens) M"><span class="size-caption">M</span></label>
										</td>
										<td>
											<label><input type="radio" name="size" value="Mens) L"><span class="size-caption">L</span></label>
										</td>
									</tr>
									<tr>
										<td>
											<span class="size-category">Kids</span>
										</td>
										<td>
											<label><input type="radio" name="size" value="Kids) 80"><span class="size-caption">80</span></label>
										</td>
										<td>
											<label><input type="radio" name="size" value="Kids) 90"><span class="size-caption">90</span></label>
										</td>
										<td>
											<label><input type="radio" name="size" value="Kids) 100"><span class="size-caption">100</span></label>
										</td>
										<td>
											<label><input type="radio" name="size" value="Kids) 110"><span class="size-caption">110</span></label>
										</td>
										<td>
											<label><input type="radio" name="size" value="Kids) 120"><span class="size-caption">120</span></label>
										</td>
										<td>
											<label><input type="radio" name="size" value="Kids) 130"><span class="size-caption">130</span></label>
										</td>
									</tr>
								</table>
						</div>
					</div>
					</div>
				</div>
			</main>
			<footer>
				<div class="footer-container">
					<button class="button_command" type=button onclick="jumpto_index()">選びなおす</button>
					<button class="button_command" type=button onclick="getPrintData()">印刷</button>
				</div>
				<div class="footer-command-area">
					<button class="button_caution" type=button onclick="endproc_order()">終 了</button>
				</div>
			</footer>
		</div>

		<script src="js/selecter.js"></script>
		<script src="js/connect.js"></script>
		<script src="js/camera.js"></script>
		<script src="js/forma.js"></script>
		<script>
			// **********************
			// ページロード時の処理
			// **********************
			window.onload = function() {
				debugConsole_proc('window.onload()');		
				// index-Loadingを閉じる
				const spinner = document.getElementById('index-loading');
				spinner.classList.add('loaded');
				
				// 初期処理
				index_onloaded();
				camera_onloaded();
			}
			// index.htmlがロードされた時の処理
			function index_onloaded() {
				debugConsole_proc('index_onloaded()');

				//------------------------------
				// ロード時の処理
				//------------------------------
				try
				{
						console.log('fromHTML_call_Loaded_pageindex');
						let obj =  fromHTML_call_Loaded_pageindex();
						let msg = '';
						for(let i=0;i<obj.length;i++)
						{
								msg += obj[i] + '\t';
						}
				}
				catch(e)
				{
						
				}
				//------------------------------
				// 最後に選択されていたカテゴリを反映
				//------------------------------
				try
				{	
					console.log('fromHTML_call_Category');
					obj = fromHTML_call_Get_Category();
					if(obj.length == 3)
					{
						setItemListTree(obj);
					}
				}
				catch(e)
				{

				}
			}
			// camera.htmlがロードされた時の処理
			function camera_onloaded() {
				debugConsole_proc('camera_onloaded()');
        // カメラの初期化
        jsCameraStart();

        // Formaにログインする。
        // htmlからもできるように　user pass コード内
        try
        {
          let obj = fromHTML_call_Loaded_pagecamera();
          LogIn(obj[0], obj[1]);
        }
        catch(e)
        {
          console.log(e);
        }
        // 対象アイテムの取得
        try
        {
          let obj = fromHTML_call_Get_ItemUUID();
          document.getElementById('itemuuid').textContent = obj;
          uuid_tryon_item = obj;
        }
        catch(e)
        {
          console.log(e);
        }
        // 対象アバターの取得
        try
        {
          let obj = fromHTML_call_Get_AvatarUUID();
          document.getElementById('avataruuid').textContent = obj;
          uuid_tryon_avatar = obj;
          if(uuid_tryon_avatar != '')
          {
            document.getElementById('reuseAvatar').classList.remove('item-hide');
          }
        }
        catch(e)
        {
          console.log(e);
        }

      };
		
			// **********************
			// ページ間の移動
			// **********************
			//------------------------
			// メインページ(セレクタ)に遷移する。
			// index.html
			//------------------------
			function jumpto_index() {
				debugConsole_proc('jumpto_index()');
				// 消し込み
				hide_camera();
				hide_order();
				// 表示
				show_index();
			}
			//------------------------
			// カメラページに遷移する。
			// camera.html
			//------------------------
			function jumpto_Camera() {
				debugConsole_proc('jumpto_Camera()');
				// 選択アイテムのチェック
				if(!IsSelectItem())return;
				if(!IsHaveUUID())return;

				// 選択中のItemのUUIDを設定する。
				document.getElementById('itemuuid').textContent = GetSelected_Item().uuid;
				Set_itemUUid(GetSelected_Item().uuid);
				console.log(`uuid_try_item = ${uuid_tryon_item}`);

				// Avatarが存在すれば、前回の写真からを有効にする
				document.getElementById('avataruuid').textContent = Get_avatarUUid();
				if(Get_avatarUUid() != '')
				{
					document.getElementById('reuseAvatar').classList.remove('item-hide');
				}
				else
				{
					document.getElementById('reuseAvatar').classList.add('item-hide');
				}

				hide_index();
				show_camera();
			}
			//------------------------
			// 注文ページに遷移する。
			// order.html
			//------------------------
			function jumpto_Order() {
				debugConsole_proc('jumpto_Order()');
				// 選択アイテムのチェック
				if(!IsSelectItem())return;

				// 選択中のアイテムを反映
				document.getElementById('order_design_image').src = GetSelected_Item().designsrc;
				document.getElementById('designID').textContent = GetSelected_Item().designID;

				// ほかのページを消し込む
				hide_index();
				hide_camera();

				// 対象ページを開く
				show_order();
			}
			
			// **********************
			// ページ内遷移
			// **********************
			//------------------------
			// カメラページのプライバシーポリシー
			// [すすむ]
			//------------------------
			function camera_accept_click() {
				// プライバシーの消し込み
				document.getElementById('modal').classList.add('hidden');
				document.getElementById('mask').classList.add('hidden');
				// カメラの表示
				document.getElementById('camera-page').classList.remove('loaded');
				// カメラの開始
				const video = document.querySelector("#camera");
				syncCamera(video);
			}
			// **********************
			// 各ページ共通の処理
			// **********************
			// 終了処理
			function endproc() {
				// 現在のItem・Avatarをクリアする。
				Set_itemUUid('');
	      Set_avatarUUid('');

				// 表示の初期化
				clear_selectitem();
				setCategoryListTree_radiobutton();
				setItemListTree(['','','']);

				// androidに送信
				call_exit();
			}
			// 終了処理(orderでの)
			function endproc_order() {
				endproc();
				// indexに戻る
				jumpto_index();
			}
			// **********************
			// 各ページ要素の表示非表示
			// **********************
			// index.htmlの表示
			function show_index() {
				// 対象ページを開く
				document.getElementById('index-page').classList.remove('loaded');
			}
			// index.htmlの非表示
			function hide_index() {
				// 要素の消し込み
				document.getElementById('index-page').classList.add('loaded');
			}
			// camera.indexの表示
			function show_camera() {
				// 対象ページを開く
				document.getElementById('modal').classList.remove('hidden');
				document.getElementById('mask').classList.remove('hidden');
			}
			// camera.indexの非表示
			function hide_camera() {
				// 要素の消し込み
				document.getElementById('modal').classList.add('hidden');
		    document.getElementById('mask').classList.add('hidden');
		    document.getElementById('camera_result').classList.add('loaded');
				document.getElementById('camera-page').classList.add('loaded');
			}
			// order.htmlの表示
			function show_order() {
				document.getElementById('order-page').classList.remove('loaded');
			}
			// order.htmlの非表示
			function hide_order() {
				document.getElementById('order-page').classList.add('loaded');
			}
			// **********************
		
			function debugConsole_proc(message)
			{
				console.log(`[index.html]PROC :${message}`);
			}


		</script>
  </body>
</html>