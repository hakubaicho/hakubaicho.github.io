<!DOCTYPE html>
<html lang="ja">
	<head>
		<meta charset="utf-8">
    <!-- 
			幅:1080に固定する
      ほかにいいアイデアったらお願いします。
    -->
    <meta name="viewport" content="width=1080,initial-scale=1">
    <title>アイテム選択画面</title>
    <!-- Index.html -->
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/select_item.css">
    <link rel="stylesheet" href="css/accordion_check.css">
    <link rel="stylesheet" href="css/accordion_radio.css">
    <!-- Camera.html -->
    <link rel="stylesheet" href="css/camara.css">
    <link rel="stylesheet" href="css/talkstyle.css">
		
  </head>
  <body>

		<!-- ******************************************************************************* -->
		<!-- index.html -->
		<!-- ******************************************************************************* -->
		<!-- index-loading画面 -->
    <div id="index-loading">
			<div class="spinner"></div>
      <p class="title_logo">Tシャツを作ってみる！</p>
    </div>
		
    <!-- indexのメイン部分 -->
    <div id="index-page">
			<!-- HEADER -->
			<header>
				<div class="header-container">
					<!-- <p>header</p> -->
					<!-- 画像の表示　選択されたデザイン -->
					<div class="header_box">
						<img id="thumbnail_selected">
					</div>
					<div class="header_box">
						<img id="thumbnail_selected_tryon">
					</div>
					<div class="header_box header_box_last item-hide" id="detail-box">
						<div class="detail-box">
							<table class="detailtable">
								<tr>
									<td class="detail_column_title"><span class="cell_title">大分類:</span></td>
									<td class="detail_column_data"><span class="cell_data" id="item_detail_tag1"></span></td>
								</tr>
								<tr>
									<td class="detail_column_title"><span class="cell_title">中分類:</span></td>
									<td class="detail_column_data"><span class="cell_data" id="item_detail_tag2"></span></td>
								</tr>
								<tr>
									<td class="detail_column_title"><span class="cell_title">小分類:</span></td>
									<td class="detail_column_data"><span class="cell_data" id="item_detail_tag3"></span></td>
								</tr>
								<tr>
									<td class="detail_column_title"><span class="cell_title">名称:</span></td>
									<td class="detail_column_data"><span class="cell_data" id="item_detail_name"></span></td>
								</tr>
								<tr>
									<td class="detail_column_title"><span class="cell_title">No:</span></td>
									<td class="detail_column_data"><span class="cell_data" id="item_detail_designID"></span></td>
								</tr>
							</table>
						</div>
					</div>
					<!-- 画像の表示　選択されたデザインの人が試着しているもの -->
				</div>
			</header>
			
			<!-- NAV -->
			<nav>
				<div class="nav-container">
					<div class="button_category button_tag1" id="button_category_tag1"><span id="category_tag1">大分類</span></div>
					<div class="button_category button_tag2" id="button_category_tag2"><span id="category_tag2">中分類</span></div>
					<div class="button_category button_tag3" id="button_category_tag3"><span id="category_tag3">小分類</span></div>
				</div>
			</nav>
			
			<!-- MAIN-AREA -->
			<div class="main-area-container">
				<!-- MAIN -->
				<main>
					<!-- Itemの詳細を表示する -->
					<div class="main-container">
						<div class="item_list_container">
							<!-- スクロールリセット要素 -->
							<div id="topPos"></div>
							<!-- 画像のリスト -->
							<ul class="thumbnails">
							</ul>
						</div>
					</div>
				</main>
				<!-- ASEIDE -->
				<aside>
					<!-- カテゴリーを表示する -->
					<div class="aside-container">
						<div id="accordionbox" class="category_list_container"></div>
					</div>
				</aside>
			</div>
				
			<!-- FOOTER -->
			<footer>
				<!-- <p>footer</p> -->
				<div class="footer-container">
					<!-- <button class="button_command" onclick="gotoCamera()">撮影して試着</button> -->
					<button class="button_command" onclick="jumpto_Camera()">撮影して試着</button>
					<button class="button_command" onclick="gotoOrder()">撮影せずに購入</button>
				</div>
				<div class="footer-command-area">
					<button class="button_warning" onclick="setCategoryListTree_checkbox()">チェックボックス</button>
					<button class="button_warning" onclick="setCategoryListTree_radiobutton()">ラジオ</button>
					
					<button class="button_caution" onclick="location.href='test_fade.html'">試着中デモ</button>
					<button class="button_caution" onclick="call_exit()">終 了</button>
				</div>
			</footer>
		</div>
		
		<!-- ******************************************************************************* -->
		<!-- camera.html -->
		<!-- ******************************************************************************* -->
		<!-- 写真の登録・トライオン中のローディング画面 -->
		<div id="camera-loading" class="loaded">
			<!-- タイトル -->
			<p>Status : <span id="title_logo">Tシャツを作ってみる！</span></p>
			<!-- くるくる -->
			<div class="spinner"></div>
			<!-- 吹き出しでフェーズ -->
			<div class="area_talk">
				<ul class="messages">
					<!-- 1番目 -->
					<li class="left_side">
						<div class="pic">
							<!-- <img id="logo_moving_1" src="img/c1_character_pc.gif"> -->
							<img id="logo_1" src="img/c1_character_sp.gif">
							<img id="logo_moving_1" class="hidden_image" src="img/c1_character_pc.gif">
							<img id="logo_stop_1" class="hidden_image" src="img/c1_character_greet.png">
						</div>
						<div id="phase_1" class="text_conatainer">
							<div class="text_header">
								写真をとうろく
							</div>
							<div class="text" id="phase_1_text">
								<!-- あなたの写真をとうろくちゅうです -->
							</div>
						</div>
					</li>
					<!-- 2番目 -->
					<li class="right_side">
						<div class="pic">
							<!-- <img class="loading_icon_gif loading_icon_left" src="img/c2_character_pc.gif"> -->
							<img id="logo_2" src="img/c2_character_sp.gif">
							<img id="logo_moving_2" class="hidden_image" src="img/c2_character_pc.gif">
							<img id="logo_stop_2" class="hidden_image" src="img/c2_character_greet.png">
						</div>
						<div id="phase_2" class="text_conatainer">
							<div class="text_header">
								Tシャツをとうろく
							</div>
							<div class="text" id="phase_2_text">
								<!-- 着てみるTしゃつをとうろくちゅうです -->
							</div>
						</div>
					</li>
					<!-- 3番目 -->
					<li class="left_side">
						<div class="pic">
							<!-- <img id="logo_moving_3" src="img/c3_character_pc.gif"> -->
							<img id="logo_3" src="img/c3_character_sp.gif">
							<img id="logo_moving_3" class="hidden_image" src="img/c3_character_pc.gif">
							<img id="logo_stop_3" class="hidden_image" src="img/c3_character_greet.png">
						</div>
						<div id="phase_3" class="text_conatainer">
							<div class="text_header">
								きせかえ
							</div>
							<div class="text" id="phase_3_text">
								<!-- あなたにTシャツをきせています -->
							</div>
						</div>
					</li>
					<!-- 4番目 -->
					<li class="right_side">
						<div class="pic">
							<!-- <img id="logo_moving_4" src="img/c4_character_pc.gif"> -->
							<img id="logo_4" src="img/c4_character_sp.gif">
							<img id="logo_moving_4" class="hidden_image" src="img/c4_character_pc.gif">
							<img id="logo_stop_4" class="hidden_image" src="img/c4_character_greet.png">
						</div>
						<div id="phase_4" class="text_conatainer">
							<div class="text_header">
								みてみて
							</div>
							<div class="text" id="phase_4_text">
								<!-- さあ　にあっているかな？ -->
							</div>
						</div>
					</li>
					<!-- おわり -->
				</ul>
			</div>
		</div>
    <!-- モーダルウィンドウ プライバシーポリシーの表示 -->
    <section id="modal" class="hidden">
      <div>
        <!-- プライバシーポリシー文章 -->
        <div id="modal_text_container">
          <p class="permission_camera">
            プライバシーポリシー
            <br>
            下記を確認して下さい。
          </p>
          <p class="permission_message">
            ◆はじめに<br>
            株式会社テンプレートグループ（以下、当グループ）は、個人情報の取り扱いにおいて、下記のように定めます。<br>
            
            以下のプライバシーポリシーでは、個人情報の取得・利用・管理について記載しております。サービス利用にあたり、個人情報保護方針をお読みになり、ご理解いただけますと幸いです。<br>
            
            ◆個人情報の取得<br>
            当サービスでは、ユーザーの皆様の個人情報（氏名、住所、メールアドレス、電話番号など個人を特定できる情報）を取得させて頂くことがあります。<br>
            
            ◆個人情報の利用<br>
            取得した個人情報は、下記の目的で利用いたします。<br>
            (1)ユーザーニーズに合わせたサービス提供<br>
            (2)サービス改善に関するマーケティング<br>
            (3)資料送付などの際の本人確認<br>
            
            ◆個人情報の安全管理<br>
            当グループでは個人情報の管理について、全従業員・役員に対して第三者機関による教育研修を四半期に1度のペースで実施しています。<br>
            また社則に個人情報保護規定を設け、現場での管理について厳格にチェックを行っています。<br>
            
            ◆第三者への開示・提供の禁止<br>
            基本的に個人情報は第三者には提供しませんが、個人情報の保護に関する法律第23条第1項各号により、法令に基づいて提供する場合があります。<br>
            
            ◆個人情報に関する問い合わせ<br>
            個人情報に関するお問い合わせは、下記までお願い致します。<br>
            情報管理部 担当:山下<br>
            電話番号:0120-000-000<br>
            メールアドレス:jouhoukanri@xxxxxxx<br>
            
            ◆改変と見直しについて<br>
            個人情報については、法令変更などを受けて随時見直しを行います。<br>
          </p>
        </div>
      </div>
      <!-- 今回の写真撮影 -->
      <div class="footer-container">
        <button id="cancel" onclick="jumpto_index_from_camera()" class="button_command">やめる</button>
        <button id="accept" onclick="camera_accept_click()" class="button_command hidden">撮影する</button>
      </div>
      <!-- 前回の写真の再利用 -->
      <div id="after_login" class="item-hide">
        <div class="footer-container">
          <button id="reuseAvatar" class="button_command item-hide">前回の写真から</button>
        </div>
      </div>
    </section>
    <!-- モーダルウィンドウの時のマスク -->
    <div id="mask" class="hidden"></div>
		<!-- カメラ撮影結果表示 -->
		<div id="camera_result" class="loaded">
			<!-- 画像の表示エリア -->
			<div id="camera_result_header">
				<!-- TryOnの結果画像 -->
				<img id="tryon_result_picture">
			</div>
			<!-- ボタンエリア -->
			<div  id="camera_result_footer">
				<div class="footer-container">
					<button class="button_command" onclick="jumpto_index_from_camera()">選びなおす</button>
					<button class="button_command" onclick="location.href='order.html'">購入</button>
				</div>
			</div>
		</div>
		<!-- indexのメイン部分 -->
		<div id="camera-page" class="loaded">
			<!-- HEADER -->
			<!-- NAV -->
			<!-- MAIN -->
			<main>
				<!-- カメラ -->
				<div id="area-capture" class="area-container">
					<div id="video_container">
						<!-- VIDEOの映像 -->
						<video id="camera" autoplay="1">
							<p>動画の再生に対応していません</p>
						</video>
						<!-- チャプチャーした画像 -->
						<canvas id="canvas-photo"></canvas>
					</div>
				</div>
			</main>
			
			
			<!-- FOOTER -->
			<footer>
				<!-- コントロールボタン -->
				<div id="area-button" class="area-container">
					<div class="box_command">
						<!-- <img src="img/arrow_left.png" id="btn_image_back" onclick="btnimg_click_back()"> -->
						<img src="img/arrow_left.png" id="btn_image_back" onclick="jumpto_index_from_camera()">
						<p>選びなおす</p>
					</div>
					<div class="box_command">
						<img src="img/shutter.png" id="btn_image_shutter" onclick="btnimg_click_shutter()">
						<p>撮影</p>
						<p>(撮り直し)</p>
					</div>
					<div class="box_command">
						<img src="img/arrow_right.png" id="btn_image_save" onclick="btnimg_click_save()">
						<p>試着</p>
					</div>
				</div>
				<div>
					<p>
						<span id="camera-status"></span>
					</p>
					<p>
						<span id="Forma_status"></span>
					</p>
					<p>
						<span id="forma_login"></span>
					</p>
					<p>
						<span id="itemuuid"></span>
					</p>
					<p>
						<span id="avataruuid"></span>
					</p>
				</div>
				<!-- 音声 -->
				<div id="area-sound" class="area-container" hidden>
					<p>
						<button type=button onclick="play_countdown()">テスト再生</button>
						<span>再生状態:<span id="soundStatus"></span></span>
					</p>
					<!-- 
						audioタグで先読みしておいたほうがいいです。
						じゃないとエラーが出ました。
						controlsでコントロールGUIの表示をします。
					-->
					<audio id="sound-countdown" controls src="sound/countdown3to1.mp3"></audio>
					<audio id="sound-shutter" controls src="sound/shutter.mp3"></audio>
				</div>
				<!-- カメラコントロール -->
				<div id="area-camera-ctrl" class="area-container">
					<!-- 解像度の設定ボタン -->
					<div>
						<button type="button" class="button_command" onclick="videoSize(1024, 576)">H:1024 * W:576</button>
						<button type="button" class="button_command" onclick="videoSize(576, 1024)">H:576 * W:1024</button>
					</div>
					<!-- VIDEO選択画面 -->
					<div>
						<select id="camera_list" size="1" style="width:160pt;">
							<option>(video)</option>
						</select>
						<button id="start_video_button" class="button_command" onclick="startSelectedVideo()">Start Video</button>
					</div>
					<p>H:<span id="resolution-height"></span></p>
					<p>W:<span id="resolution-width"></span></p>
					<div id="camera-devices">
						<p>mediaDevicesを列挙します。</p>
						<button type="button" onclick="getCameraDevices()">取得</button>
						<div id="list-camera-devices">
						</div>
					</div>
				</div>
			</footer>
		</div>

		<!-- ******************************************************************************* -->
		<!-- order.html -->
		<!-- ******************************************************************************* -->


		<script src="js/selecter.js"></script>
		<script src="js/connect.js"></script>
		<script src="js/camera.js"></script>
		<script src="js/forma.js"></script>
		<script>
			window.onload = function() {
							
				// index-Loadingを閉じる
				const spinner = document.getElementById('index-loading');
				spinner.classList.add('loaded');
				
				// 初期処理
				try
				{
						console.log('fromHTML_call_Loaded_pageindex');
						let obj =  fromHTML_call_Loaded_pageindex();
						let msg = '';
						for(let i=0;i<obj.length;i++)
						{
								msg += obj[i] + '\t';
						}
				}
				catch(e)
				{
						
				}
				try
				{
					// 最後のカテゴリ
					console.log('fromHTML_call_Category');
					obj = fromHTML_call_Get_Category();
					if(obj.length == 3)
					{
						setItemListTree(obj);
					}
				}
				catch(e)
				{

				}

				cameraonload();
			}
			function cameraonload() {
        // カメラの初期化
        jsCameraStart();

        // Formaにログインする。
        // htmlからもできるように　user pass コード内
        try
        {
          let obj = fromHTML_call_Loaded_pagecamera();
          LogIn(obj[0], obj[1]);
        }
        catch(e)
        {
          console.log(e);
        }
        // 対象アイテムの取得
        try
        {
          let obj = fromHTML_call_Get_ItemUUID();
          document.getElementById('itemuuid').textContent = obj;
          uuid_tryon_item = obj;
        }
        catch(e)
        {
          console.log(e);
        }
        // 対象アバターの取得
        try
        {
          let obj = fromHTML_call_Get_AvatarUUID();
          document.getElementById('avataruuid').textContent = obj;
          uuid_tryon_avatar = obj;
          if(uuid_tryon_avatar != '')
          {
            document.getElementById('reuseAvatar').classList.remove('item-hide');
          }
        }
        catch(e)
        {
          console.log(e);
        }

      };
		
			// カメラ撮影からメインページに遷移する
			function jumpto_index_from_camera() {
				// ほかのページを消し込む
				document.getElementById('modal').classList.add('hidden');
		    document.getElementById('mask').classList.add('hidden');
		    document.getElementById('camera_result').classList.add('loaded');
				document.getElementById('camera-page').classList.add('loaded');

				// 対象ページを開く
				document.getElementById('index-page').classList.remove('loaded');
			}
			// プライバシーポリシーの[すすむ]
			function camera_accept_click() {
				// プライバシーの消し込み
				document.getElementById('modal').classList.add('hidden');
				document.getElementById('mask').classList.add('hidden');
				// カメラの表示
				document.getElementById('camera-page').classList.remove('loaded');
				// カメラの開始
				const video = document.querySelector("#camera");
				syncCamera(video);
			}

			function jumpto_Camera() {
				if(!IsSelectItem())return;
				if(!IsHaveUUID())return;

				// ほかのページを消し込む
				document.getElementById('index-page').classList.add('loaded');

				// 対象ページを開く
				document.getElementById('modal').classList.remove('hidden');
				document.getElementById('mask').classList.remove('hidden');
				// document.getElementById('camera-page').classList.remove('loaded');
 			 }
			
			function jumpto_Order() {

			}
		
		</script>
  </body>
</html>